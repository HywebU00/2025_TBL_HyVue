import{m as R,V as I,a as E,b}from"./VOverlay.1cf68bfe.js";import{f as L}from"./forwardRefs.890e72a9.js";import{p as S,ao as O,z as K,G as U,B,q as F,e as V,f as z,i as H,s as N,k as $,aC as j,v as q,t as G,F as J,a as k,m as A,aD as Q,aA as p,O as W,ap as g}from"./index.1db8eb8a.js";import{u as X}from"./scopeId.c06eaa9d.js";import{u as Y,i as Z}from"./index.19587dc7.js";const _=S({id:String,submenu:Boolean,...O(R({closeDelay:250,closeOnContentClick:!0,locationStrategy:"connected",location:void 0,openDelay:300,scrim:!1,scrollStrategy:"reposition",transition:{component:I}}),["absolute"])},"VMenu"),se=K()({name:"VMenu",props:_(),emits:{"update:modelValue":t=>!0},setup(t,P){let{slots:c}=P;const l=U(t,"modelValue"),{scopeId:h}=X(),{isRtl:f}=B(),d=F(),m=V(()=>t.id||`v-menu-${d}`),s=z(),a=H(E,null),v=N(new Set);$(E,{register(){v.value.add(d)},unregister(){v.value.delete(d)},closeParents(e){setTimeout(()=>{var n;!v.value.size&&!t.persistent&&(e==null||((n=s.value)==null?void 0:n.contentEl)&&!j(e,s.value.contentEl))&&(l.value=!1,a==null||a.closeParents())},40)}}),q(()=>a==null?void 0:a.unregister()),G(()=>l.value=!1);async function y(e){var u,r,i;const n=e.relatedTarget,o=e.target;await W(),l.value&&n!==o&&((u=s.value)==null?void 0:u.contentEl)&&((r=s.value)==null?void 0:r.globalTop)&&![document,s.value.contentEl].includes(o)&&!s.value.contentEl.contains(o)&&((i=p(s.value.contentEl)[0])==null||i.focus())}J(l,e=>{e?(a==null||a.register(),document.addEventListener("focusin",y,{once:!0})):(a==null||a.unregister(),document.removeEventListener("focusin",y))});function C(e){a==null||a.closeParents(e)}function D(e){var n,o,u,r,i;if(!t.disabled)if(e.key==="Tab"||e.key==="Enter"&&!t.closeOnContentClick){if(e.key==="Enter"&&(e.target instanceof HTMLTextAreaElement||e.target instanceof HTMLInputElement&&!!e.target.closest("form")))return;e.key==="Enter"&&e.preventDefault(),Q(p((n=s.value)==null?void 0:n.contentEl,!1),e.shiftKey?"prev":"next",M=>M.tabIndex>=0)||(l.value=!1,(u=(o=s.value)==null?void 0:o.activatorEl)==null||u.focus())}else t.submenu&&e.key===(f.value?"ArrowRight":"ArrowLeft")&&(l.value=!1,(i=(r=s.value)==null?void 0:r.activatorEl)==null||i.focus())}function w(e){var o;if(t.disabled)return;const n=(o=s.value)==null?void 0:o.contentEl;n&&l.value?e.key==="ArrowDown"?(e.preventDefault(),e.stopImmediatePropagation(),g(n,"next")):e.key==="ArrowUp"?(e.preventDefault(),e.stopImmediatePropagation(),g(n,"prev")):t.submenu&&(e.key===(f.value?"ArrowRight":"ArrowLeft")?l.value=!1:e.key===(f.value?"ArrowLeft":"ArrowRight")&&(e.preventDefault(),g(n,"first"))):(t.submenu?e.key===(f.value?"ArrowLeft":"ArrowRight"):["ArrowDown","ArrowUp"].includes(e.key))&&(l.value=!0,e.preventDefault(),setTimeout(()=>setTimeout(()=>w(e))))}const x=V(()=>A({"aria-haspopup":"menu","aria-expanded":String(l.value),"aria-owns":m.value,onKeydown:w},t.activatorProps));return Y(()=>{var n;const e=b.filterProps(t);return k(b,A({ref:s,id:m.value,class:["v-menu",t.class],style:t.style},e,{modelValue:l.value,"onUpdate:modelValue":o=>l.value=o,absolute:!0,activatorProps:x.value,location:(n=t.location)!=null?n:t.submenu?"end":"bottom","onClick:outside":C,onKeydown:D},h),{activator:c.activator,default:function(){for(var o=arguments.length,u=new Array(o),r=0;r<o;r++)u[r]=arguments[r];return k(Z,{root:"VMenu"},{default:()=>{var i;return[(i=c.default)==null?void 0:i.call(c,...u)]}})}})}),L({id:m,\u03A8openChildren:v},s)}});export{se as V};
